<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mom's Recipes</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: Georgia, serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background: #faf8f5;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #8b4513;
      border-bottom: 2px solid #d4a574;
      padding-bottom: 10px;
    }
    select {
      width: 100%;
      padding: 12px;
      font-size: 18px;
      font-family: inherit;
      border: 2px solid #d4a574;
      border-radius: 8px;
      background: white;
      margin-bottom: 20px;
    }
    .recipe {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .recipe h2 {
      color: #8b4513;
      margin-top: 0;
    }
    .recipe img {
      width: 100%;
      max-width: 500px;
      border-radius: 8px;
      margin: 15px 0;
      display: block;
    }
    .recipe h3 {
      color: #a0522d;
      margin-bottom: 8px;
    }
    .recipe ul, .recipe ol {
      margin: 0 0 20px 0;
      padding-left: 20px;
    }
    .recipe li { margin: 5px 0; }
    .recipe p { line-height: 1.6; }
    .meta { color: #888; font-size: 14px; margin-bottom: 15px; }
    .category {
      display: inline-block;
      background: #d4a574;
      color: white;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 12px;
      text-transform: uppercase;
      margin-bottom: 10px;
    }
    #recipe-container { display: none; }
    #recipe-container.active { display: block; }
    .instructions { white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>Mom's Recipes</h1>

  <select id="recipe-select">
    <option value="">-- Select a Recipe --</option>
    <optgroup label="Thanksgiving - Desserts">
      <option value="thanksgiving/desserts/buttermilk-chess-pie">Buttermilk Chess Pie</option>
      <option value="thanksgiving/desserts/no-bake-cookies">No Bake Cookies</option>
      <option value="thanksgiving/desserts/peanut-butter-ball-dip">Peanut Butter Ball (Dip)</option>
      <option value="thanksgiving/desserts/peanut-butter-balls">Peanut Butter Balls</option>
      <option value="thanksgiving/desserts/pecan-pie">Pecan Pie</option>
      <option value="thanksgiving/desserts/pumpkin-pie">Pumpkin Pie</option>
    </optgroup>
    <optgroup label="Thanksgiving - Sides">
      <option value="thanksgiving/savory-tings/corn-casserole">Corn Casserole</option>
      <option value="thanksgiving/savory-tings/cranberry-salad">Cranberry Salad</option>
      <option value="thanksgiving/savory-tings/fruit-salad-with-cannoli-cream">Fruit Salad with Cannoli Cream</option>
      <option value="thanksgiving/savory-tings/garlic-mashed-potatoes">Garlic Mashed Potatoes</option>
      <option value="thanksgiving/savory-tings/green-beans-amandine">Green Beans Amandine</option>
      <option value="thanksgiving/savory-tings/marinated-vegetable-salad">Marinated Vegetable Salad</option>
      <option value="thanksgiving/savory-tings/sweet-potato-casserole">Sweet Potato Casserole</option>
      <option value="thanksgiving/savory-tings/taffy-apple-salad">Taffy Apple Salad</option>
      <option value="thanksgiving/savory-tings/thanksgiving-turkey-dressing">Thanksgiving Turkey Dressing</option>
      <option value="thanksgiving/savory-tings/caramels">Caramels</option>
      <option value="thanksgiving/savory-tings/caramel-apple-crumble-pie">Caramel Apple Crumble Pie</option>
    </optgroup>
    <optgroup label="Appetizers">
      <option value="misc/bruschetta">Bruschetta</option>
      <option value="misc/cranberry-pecan-brie-cups">Cranberry Pecan Brie Cups</option>
      <option value="misc/pesto-palmiers">Pesto Palmiers</option>
      <option value="misc/stuffed-mushrooms">Stuffed Mushrooms</option>
    </optgroup>
    <optgroup label="Main Dishes">
      <option value="misc/bourbon-bbq-pork-chops">Bourbon BBQ Pork Chops</option>
      <option value="misc/caprese-stuffed-chicken">Caprese Stuffed Chicken</option>
      <option value="misc/sausage-quiche">Sausage Quiche</option>
      <option value="misc/zucchini-lasagna">Zucchini Lasagna</option>
    </optgroup>
    <optgroup label="Sides & Salads">
      <option value="misc/cabbage-ramen-salad">Cabbage Ramen Salad</option>
      <option value="misc/creamy-parmesan-spinach-bake">Creamy Parmesan Spinach Bake</option>
      <option value="misc/mac-and-cheese">Mac & Cheese</option>
      <option value="misc/sage-and-onion-stuffing">Sage and Onion Stuffing</option>
      <option value="misc/tomato-relish">Tomato Relish</option>
    </optgroup>
    <optgroup label="Breakfast">
      <option value="misc/german-pancakes">German Pancakes</option>
      <option value="misc/lemon-blueberry-dutch-baby">Lemon Blueberry Dutch Baby</option>
    </optgroup>
    <optgroup label="Cookies">
      <option value="misc/chocolate-cookies">Chocolate Cookies</option>
      <option value="misc/chocolate-crackle-cookie">Chocolate Crackle Cookie</option>
      <option value="misc/cut-out-sugar-cookies">Cut Out Sugar Cookies</option>
      <option value="misc/frosted-butter-cutout-cookies">Frosted Butter Cutout Cookies</option>
      <option value="misc/glazed-lemon-cookies">Glazed Lemon Cookies</option>
      <option value="misc/hedgehog-cookies">Hedgehog Cookies</option>
      <option value="misc/meringue-cookies">Meringue Cookies</option>
      <option value="misc/no-bake-chocolate-oatmeal-cookies">No Bake Chocolate Oatmeal Cookies</option>
      <option value="misc/snickerdoodles">Snickerdoodles</option>
    </optgroup>
    <optgroup label="Candy & Treats">
      <option value="misc/baklava-palmiers">Baklava Palmiers</option>
      <option value="misc/chocolate-mice">Chocolate Mice</option>
      <option value="misc/english-toffee">English Toffee</option>
      <option value="misc/knox-blox">Knox Blox</option>
      <option value="misc/night-before-christmas-mice">Night Before Christmas Mice</option>
      <option value="misc/palmiers">Palmiers (Sugar)</option>
    </optgroup>
    <optgroup label="Pies & Tarts">
      <option value="misc/banana-cream-pretzel-pie">Banana Cream Pretzel Pie</option>
      <option value="misc/banana-pineapple-pudding-pie">Banana Pineapple Pudding Pie</option>
      <option value="misc/lemon-pecan-slab-pie">Lemon Pecan Slab Pie</option>
      <option value="misc/nutella-tart">Nutella Tart</option>
      <option value="misc/smore-pie">S'more Pie</option>
    </optgroup>
    <optgroup label="Cakes & Desserts">
      <option value="misc/bourbon-salted-caramel-brownies">Bourbon Salted Caramel Brownies</option>
      <option value="misc/bread-pudding">Bread Pudding</option>
      <option value="misc/chocolate-almond-macaroons">Chocolate Almond Macaroons</option>
      <option value="misc/chocolate-cream-layered-dessert">Chocolate Cream Layered Dessert</option>
      <option value="misc/gooey-butter-cake">Gooey Butter Cake</option>
      <option value="misc/nutella-bread-pudding">Nutella Bread Pudding</option>
      <option value="misc/paula-deens-banana-pudding">Paula Deen's Banana Pudding</option>
      <option value="misc/peach-crumble">Peach Crumble</option>
      <option value="misc/pumpkin-pudding">Pumpkin Pudding</option>
    </optgroup>
    <optgroup label="Jello & Salads">
      <option value="misc/lime-pretzel-jello">Lime Pretzel Jello</option>
    </optgroup>
    <optgroup label="Breads">
      <option value="misc/almond-tea-bread">Almond Tea Bread</option>
      <option value="misc/cream-cheese-pastry">Cream Cheese Pastry</option>
      <option value="misc/nutella-christmas-tree">Nutella Christmas Tree</option>
    </optgroup>
    <optgroup label="Holiday Fun">
      <option value="misc/mini-strawberry-santas">Mini Strawberry Santas</option>
      <option value="misc/witches-hat">Witch's Hat Cookies</option>
    </optgroup>
  </select>

  <div id="recipe-container"></div>

  <script>
    const recipeSelect = document.getElementById('recipe-select');
    const recipeContainer = document.getElementById('recipe-container');

    recipeSelect.addEventListener('change', async function() {
      if (!this.value) {
        recipeContainer.classList.remove('active');
        return;
      }

      try {
        const response = await fetch(this.value + '.json');
        const recipe = await response.json();
        displayRecipe(recipe, this.value);
        recipeContainer.classList.add('active');
      } catch (error) {
        recipeContainer.innerHTML = '<p>Error loading recipe. Please try again.</p>';
        recipeContainer.classList.add('active');
      }
    });

    function displayRecipe(recipe, path) {
      const folder = path.split('/').slice(0, -1).join('/');
      let html = '';

      // Category badge
      const category = getCategoryFromPath(path);
      html += `<span class="category">${category}</span>`;

      // Title
      html += `<h2>${recipe.title}</h2>`;

      // Meta info
      let meta = [];
      if (recipe.oven_temp) meta.push(recipe.oven_temp);
      if (recipe.bake_time) meta.push(recipe.bake_time);
      if (recipe.yields) meta.push(`Yields: ${recipe.yields}`);
      if (recipe.servings) meta.push(`Serves: ${recipe.servings}`);
      if (meta.length) html += `<div class="meta">${meta.join(' | ')}</div>`;

      // Image(s)
      if (recipe.source_image) {
        html += `<img src="${folder}/${recipe.source_image}" alt="${recipe.title} recipe card">`;
      } else if (recipe.source_images) {
        html += `<img src="${folder}/${recipe.source_images[0]}" alt="${recipe.title} recipe card">`;
      }

      // Ingredients
      if (recipe.ingredients) {
        if (Array.isArray(recipe.ingredients)) {
          html += '<h3>Ingredients</h3><ul>';
          recipe.ingredients.forEach(i => html += `<li>${i}</li>`);
          html += '</ul>';
        } else {
          // Object with categories
          for (const [key, items] of Object.entries(recipe.ingredients)) {
            html += `<h3>${formatKey(key)}</h3><ul>`;
            items.forEach(i => html += `<li>${i}</li>`);
            html += '</ul>';
          }
        }
      }

      // Handle different ingredient formats
      const ingredientKeys = ['cookie_ingredients', 'crust_ingredients', 'filling_ingredients',
        'topping_ingredients', 'base_ingredients', 'sauce_ingredients', 'glaze_ingredients',
        'frosting_ingredients', 'royal_icing_ingredients', 'coating', 'pudding_ingredients',
        'layer_1', 'layer_2', 'layer_3', 'topping', 'filling', 'crumble_topping'];

      ingredientKeys.forEach(key => {
        if (recipe[key]) {
          const items = Array.isArray(recipe[key]) ? recipe[key] :
            (recipe[key].ingredients ? recipe[key].ingredients : []);
          if (items.length) {
            html += `<h3>${formatKey(key)}</h3><ul>`;
            items.forEach(i => html += `<li>${i}</li>`);
            html += '</ul>';
          }
        }
      });

      // Instructions
      if (recipe.instructions) {
        html += '<h3>Instructions</h3>';
        if (Array.isArray(recipe.instructions)) {
          html += '<ol>';
          recipe.instructions.forEach(i => html += `<li>${i}</li>`);
          html += '</ol>';
        } else {
          html += `<p class="instructions">${recipe.instructions}</p>`;
        }
      }

      // Storage notes
      if (recipe.storage) {
        html += `<h3>Storage</h3><p>${recipe.storage}</p>`;
      }

      // Nutrition
      if (recipe.nutrition) {
        html += `<h3>Nutrition</h3><p>${recipe.nutrition}</p>`;
      }

      recipeContainer.innerHTML = '<div class="recipe">' + html + '</div>';
    }

    function formatKey(key) {
      return key.replace(/_/g, ' ')
        .replace(/([A-Z])/g, ' $1')
        .split(' ')
        .map(word => word.charAt(0).toUpperCase() + word.slice(1))
        .join(' ')
        .replace('Ingredients', '')
        .trim() || 'Ingredients';
    }

    function getCategoryFromPath(path) {
      if (path.includes('desserts')) return 'Dessert';
      if (path.includes('savory')) return 'Side';
      if (path.includes('misc')) {
        const name = path.split('/').pop();
        if (name.includes('cookie')) return 'Cookie';
        if (name.includes('pie') || name.includes('tart')) return 'Pie';
        if (name.includes('bread') || name.includes('pastry')) return 'Bread';
        return 'Recipe';
      }
      return 'Recipe';
    }
  </script>
</body>
</html>
